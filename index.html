<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø¥Ø¶Ø§ÙØ© Ø¨Ø·Ø§Ù‚Ø§Øª ØµÙØ±Ø§Ø¡ Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ†</title>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; }
        .player { margin: 10px; padding: 10px; border: 1px solid #333; display: inline-block; width: 150px; }
        #microphone { margin-top: 20px; cursor: pointer; font-size: 24px; }
        #transcript { margin-top: 20px; font-size: 18px; }
        .results { margin-top: 30px; }
    </style>
</head>
<body>
    <h1>Ø¥Ø¶Ø§ÙØ© Ø¨Ø·Ø§Ù‚Ø§Øª ØµÙØ±Ø§Ø¡ Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ†</h1>
    <div class="results">
        <div class="player" id="player-mohamed">Ù…Ø­Ù…Ø¯ - Ø¨Ø·Ø§Ù‚Ø§Øª ØµÙØ±Ø§Ø¡: <span id="mohamed-cards">0</span></div>
        <div class="player" id="player-tarek">Ø·Ø§Ø±Ù‚ - Ø¨Ø·Ø§Ù‚Ø§Øª ØµÙØ±Ø§Ø¡: <span id="tarek-cards">0</span></div>
        <div class="player" id="player-khaled">Ø®Ø§Ù„Ø¯ - Ø¨Ø·Ø§Ù‚Ø§Øª ØµÙØ±Ø§Ø¡: <span id="khaled-cards">0</span></div>
    </div>

    <button id="microphone">ğŸ¤ Ø§Ø¶ØºØ· Ù„Ù„ØªØ­Ø¯Ø«</button>
    <div id="transcript">Ø§Ù„Ù†Øµ Ø§Ù„Ù…Ø­ÙˆÙ‘Ù„: <span id="recognized-text"></span></div>

    <script>
        // ØªÙˆØ­ÙŠØ¯ Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø¨Ø¯ÙˆÙ† Ù‡Ù…Ø²Ø§Øª Ø£Ùˆ ØªØ§Ø¡ Ù…Ø±Ø¨ÙˆØ·Ø©
        const players = {
            "Ù…Ø­Ù…Ø¯": 0,
            "Ø·Ø§Ø±Ù‚": 0,
            "Ø®Ø§Ù„Ø¯": 0
        };

        const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
        recognition.lang = "ar-SA";

        document.getElementById("microphone").onclick = () => {
            recognition.start();
        };

        recognition.onresult = (event) => {
            const transcript = event.results[0][0].transcript.trim();
            document.getElementById("recognized-text").innerText = transcript;
            processCommand(transcript);
        };

        function processCommand(command) {
            const regex = /^Ø¨Ø·Ø§Ù‚[Ù‡Ø©] ØµÙØ±Ø§Ø¡ (.+)$/;
            const match = command.match(regex);

            if (match) {
                let playerName = normalizeText(match[1]);
                if (players[playerName] !== undefined) {
                    addYellowCard(playerName);
                } else {
                    const suggestions = findPartialMatches(playerName);
                    if (suggestions.length > 0) {
                        let suggestionText = "Ù‡Ù„ ÙƒÙ†Øª ØªÙ‚ØµØ¯: \n";
                        suggestions.forEach((suggestion, index) => {
                            suggestionText += `${index + 1}. ${suggestion}\n`;
                        });
                        suggestionText += "\nØ§Ø®ØªØ± Ø±Ù‚Ù… Ø§Ù„Ù„Ø§Ø¹Ø¨ Ø£Ùˆ Ø§Ø¶ØºØ· Ø¥Ù„ØºØ§Ø¡.";
                        let choice = prompt(suggestionText);
                        if (choice && suggestions[choice - 1]) {
                            addYellowCard(suggestions[choice - 1]);
                        }
                    } else {
                        alert("Ø§Ù„Ù„Ø§Ø¹Ø¨ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯.");
                    }
                }
            } else {
                alert("Ø§Ù„Ø±Ø¬Ø§Ø¡ Ù‚ÙˆÙ„ 'Ø¨Ø·Ø§Ù‚Ø© ØµÙØ±Ø§Ø¡' Ù…ØªØ¨ÙˆØ¹Ù‹Ø§ Ø¨Ø§Ø³Ù… Ø§Ù„Ù„Ø§Ø¹Ø¨.");
            }
        }

        function addYellowCard(playerName) {
            players[playerName]++;
            updatePlayerCards(playerName);
        }

        function updatePlayerCards(playerName) {
            const playerIds = {
                "Ù…Ø­Ù…Ø¯": "mohamed-cards",
                "Ø·Ø§Ø±Ù‚": "tarek-cards",
                "Ø®Ø§Ù„Ø¯": "khaled-cards"
            };
            
            document.getElementById(playerIds[playerName]).innerText = players[playerName];
            document.getElementById("recognized-text").innerText = ""; // Ù…Ø³Ø­ Ø§Ù„Ù†Øµ Ø¨Ø¹Ø¯ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©
        }

        function normalizeText(text) {
            return text.replace(/Ø£|Ø¥|Ø¢/g, "Ø§").replace(/Ø©$/, "Ù‡");
        }

        function findPartialMatches(inputName) {
            inputName = normalizeText(inputName);
            const matches = [];

            for (let player in players) {
                let normalizedPlayer = normalizeText(player);
                if (normalizedPlayer.includes(inputName) || inputName.includes(normalizedPlayer)) {
                    matches.push(player);
                }
            }
            return matches;
        }
    </script>
</body>
</html>
